<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>Freshman Orienteering Desktop Client</title>
	<link rel='stylesheet' href='/stylesheets/desktop.css' />
    <link rel='stylesheet' href='/stylesheets/notifier-base.css' />
	<link rel='stylesheet' href='/stylesheets/notifier-theme-plastic.css' />
	<link href='http://fonts.googleapis.com/css?family=Arvo' rel='stylesheet' type='text/css'>
	<!-- For now commenting this to include a full jquery lib
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script>
	-->
	<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css" />
	<script data-main="/javascripts/can.helper.js" src="/dependencies/libs/require-jquery.js"></script>
	<!--script src="http://code.jquery.com/jquery-1.8.2.js"></script-->
    <script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>
    <script src="/javascripts/desktop_helper.js"></script>
	<!-- Time Picker Widget -->
	<script src="/javascripts/timepicker.js"></script>
</head>
<body>
		<header id="banner" class="body">
		<h1><a href="desktop">Freshman Orienteering</a></h1>
		<div id="organizerName">&nbsp;</div>
		<nav>
			<li><a href="desktop">Home</a></li>
			<li class="active"><a href="desktop_create">Create Event</a></li>
			<li><a href="desktop_manage">Manage Events</a></li>
		</nav>

	</header>

	<div id="content">
				<form id="event_form" action="">
					<input type="text" id="title" class="wide" size="30" placeholder="Event Name" style="font-size: 36px;" autocomplete="off" maxlength="255" required><br />
					<input type="text" id="location" class="wide" style="font-size: 18px;" value="" placeholder="Double-click the map to mark the start location" required disabled><br />
					<input type="text" id="starttime" class="wide" style="font-size: 18px;" value="" placeholder="Start Time" autocomplete="off" required><br />
					<input type="text" id="endtime" class="wide" style="font-size: 18px;" placeholder="End Time" value="" autocomplete="off" required><br />
					<textarea id="description" class="wide" style="font-size: 18px;" rows = "6" placeholder="Enter Description" value="" autocomplete="off"  maxlength="1024" required></textarea><br /><br />

					<div class="onoffswitch">
					    <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="ordered">
    					<label class="onoffswitch-label" for="ordered">
        					<div class="onoffswitch-inner"></div>
        					<div class="onoffswitch-switch"></div>
    					</label>
					</div><br />

					<input type="submit" id="submitEvent" value="Create Event" class="button">
					<input type="button" id="submitCheckpoints" value="Save Event" class="button" onclick=saveCheckpoints()>
				</form>
				<div id="mapArea"></div>
	</div>

	<div id ="checkpoint_holder">
		<input type="button" id="addOption" value="New Checkpoint" class="button"><br />
	</div>

	<script type="text/javascript" src="/dependencies/underscore-1.3.3.min.js"></script>
	<script type="text/javascript" src="/dependencies/backbone-0.9.2.js"></script>
	<script type="text/javascript" src="/dependencies/backbone.notifier.js"></script>
	<script src="//api.maps.nokia.com/2.2.3/jsl.js"></script>
	<script src="/javascripts/notifier.js"></script>
	<script src="/javascripts/nokiaMaps.js"></script>
	<script src="/javascripts/geolocation.js"></script>
	
	<script>
		var i = 0;

		$(document).ready(function(){
			$("#addOption").hide();
			<!-- Adding some extra stuff here to restrict the time for start and end event -->
			var starttime = $("#starttime");
			var endtime = $("#endtime");
			starttime.datetimepicker({useLocalTimezone : true, minDate : new Date(), 
				onClose: function(dateText, inst) {
					if (endtime.val() != '') {
						var eventStartTime = starttime.datetimepicker('getDate');
						var eventEndTime = endtime.datetimepicker('getDate');
						if (eventStartTime > eventEndTime) 
							// Display some alert here about the user's error
							endtime.datetimepicker('setDate', eventStartTime);
					} else {
						endtime.val(dateText);
					}
				},
				onSelect: function (selectedDateTime){
					endtime.datetimepicker('option', 'minDate', starttime.datetimepicker('getDate') );
				}				
			});
			endtime.datetimepicker({useLocalTimezone : true, minDate : new Date(),
				onClose: function(dateText, inst) {
					if (starttime.val() != '') {
						var eventStartTime = starttime.datetimepicker('getDate');
						var eventEndTime = endtime.datetimepicker('getDate');
						if (starttime > endtime)
							// Display some alert here about the user's error
							starttime.datetimepicker('setDate', eventEndTime);
					} else {
						starttime.val(dateText);
					}
				},
				onSelect: function (selectedDateTime){
					starttime.datetimepicker('option', 'maxDate', endtime.datetimepicker('getDate') );
				}
		      	});

			$( "#checkpoint_holder" ).sortable({
				stop: function(event, ui) {
        				fixIds();
    				}
    			});
			$.getJSON("/api/v2/me", function(json) {
		 		$("#organizerName").text(json.name + " logged in");
		 		$("#organizerName").hide().fadeIn('fast');
 			});
 		});
		
		$('#event_form').submit(function() {
			saveEvent();
			return false;
		});
	</script>
</body>
</html>
